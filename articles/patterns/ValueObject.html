<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Value Object Pattern • Design Patterns in R</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="The Value Object Pattern">
<meta property="og:description" content="R6P">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">Design Patterns in R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../articles/index.html">Articles</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tidylab/R6P/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ValueObject_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Value Object Pattern</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidylab/R6P/blob/master/vignettes/patterns/ValueObject.Rmd"><code>vignettes/patterns/ValueObject.Rmd</code></a></small>
      <div class="hidden name"><code>ValueObject.Rmd</code></div>

    </div>

    
    
<!-- Details -->
<div class="alert alert-danger">
<p><strong>Caution:</strong> ValueObject is designed for demonstration purposes. Instead of directly using the design pattern as it appears in the package, you’d have to adjust the source code to the problem you are trying to solve.</p>
</div>
<!-- One line about what the function does -->
<p>A <strong>Value Object</strong> models a domain concept using natural lingo of the domain experts, such as “Passenger”, “Address”, and “Money”.</p>
<p>Any <strong>Value Object</strong> is created by a function that receives input, applies some transformations, and outputs the results in some data structure such as a vector, a list or a data.frame.</p>
<div>
<p><mark><strong>Value Objects</strong> are a vital building block of analytic applications.</mark></p>
</div>
<div id="how-it-works" class="section level2">
<h2 class="hasAnchor">
<a href="#how-it-works" class="anchor"></a>How It Works</h2>
<p>In R, a good option for creating a <strong>Value Object</strong> is to follow two instructions:</p>
<ul>
<li>A <strong>Value Object</strong> is created by a <code>function</code>, rather than a class method; and</li>
<li>A <strong>Value Object</strong> returns a <code>tibble</code>, rather than a list or a vector.</li>
</ul>
<p>In essence, a <strong>Value Object</strong> is a data type, like <code>integer</code>, <code>logical</code>, <code>Date</code> or <code>data.frame</code> data types to name a few. While the built-in data types in R fit any application, <strong>Value Objects</strong> are domain specific and as such, they fit only to a specific application. This is because, <code>integer</code> is an abstract that represent whole numbers. This abstract is useful in any application. However, a <strong>Value Object</strong> represent a high-level abstraction that appears in a particular domain.</p>
<p>An example of a <strong>Value Object</strong> is the notion of a “Person”. Any person in the world has a name. Needless to say, a person name is spelt by letters, rather than numbers. A <strong>Value Object</strong> captures these attribute as <code>tibble</code> columns and type checks:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Person</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">given</span> <span class="op">=</span> <span class="cn">NA_character_</span>, <span class="va">family</span> <span class="op">=</span> <span class="cn">NA_character_</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">given</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">given</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span><span class="op">)</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span>
    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>given <span class="op">=</span> <span class="va">given</span>, family <span class="op">=</span> <span class="va">family</span><span class="op">)</span>
    <span class="op">%&gt;%</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">given</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Instantiating a person <strong>Value Object</strong> is done by calling the <code>Person</code> constructor function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">person</span> <span class="op">&lt;-</span> <span class="fu">Person</span><span class="op">(</span>given <span class="op">=</span> <span class="st">"Bilbo"</span>, family <span class="op">=</span> <span class="st">"Baggins"</span><span class="op">)</span></code></pre></div>
<p>Getting to know the advantages of a <strong>Value Object</strong>, we should consider the typical alternative – constructing a Person by using the <code>tibble</code> function directly:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">person</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>given <span class="op">=</span> <span class="st">"Bilbo"</span>, family <span class="op">=</span> <span class="st">"Baggins"</span><span class="op">)</span></code></pre></div>
<p>Both implementations return objects with identical content and structure, that is, their column names, column types and cell values are identical. Then, why would one prefer using a <strong>Value Object</strong> and its constructor over the direct alternative?</p>
<p>There are four predominant qualities offered by the <strong>Value Object</strong> pattern which are not offered by the alternative:</p>
<ol style="list-style-type: decimal">
<li><p>Readability. Each <strong>Value Object</strong> captures a concept belonging to the problem domain. Rather than trying to infer what a <code>tibble</code> is by looking at its low-level details, the <strong>Value Object</strong> constructor descries a context on a high-level.</p></li>
<li><p>Explicitness. Since the constructor of the <strong>Value Object</strong> is a function, its expected input arguments and their type can be detailed in a helper file. Moreover, assigning input arguments with default values of specific type, such as <code>NA</code> (logical NA), <code>NA_integer_</code>, <code>NA_character_</code>, or <code>NA_Date</code> (see <code>lubridate::NA_Date</code>), expresses clearly the variable types of the <strong>Value Object</strong>.</p></li>
<li><p>Coherence. The representation of a <strong>Value Object</strong> is concentrated in one place – its constructor. Any change, mainly modifications and extensions, applied to the constructor promise the change would propagate to all instances of the Value Objects. That means, no structure discrepancies between instances that are supposed to represent the same concept.</p></li>
<li><p>Safety. The constructor may start with <a href="https://en.wikipedia.org/wiki/Defensive_programming">defensive programming</a> to ensure the qualities of its input. One important assertion is type checking. Type checking eliminated the risk of implicit type coercing. Another important assertion is checking if the lengths of the input arguments meet some criteria, say all inputs are of the same length, or more restrictively, all inputs are scalars. Having a set of checks makes the code base more robust. This is because <strong>Value Objects</strong> are regularly created with the output of other functions calls, having a set of checks serves as pseudo-tests of these functions output throughout the code.</p></li>
</ol>
<p>In addition to these qualities, there are two desirable behaviours which are not offered by directly calling <code>tibble</code>:</p>
<ol style="list-style-type: decimal">
<li><p><a href="(https://tidylab.github.io/R6P/articles/patterns/NullObject.html)">Null Value Object</a>. Calling the <strong>Value Object</strong> constructor with no input arguments returns the structure of the <code>tibble</code> (column names and column types).</p></li>
<li><p>Default values for missing input arguments. In this manner, the <strong>Value Object</strong> has a well-defined behaviour for a person without a family name, such as Madonna and Bono.</p></li>
</ol>
<p>In addition to native R data types, a <strong>Value Object</strong> constructor can receive other <strong>Value Objects</strong> as input arguments. Here are two examples that transmute Person to other Person-based concepts:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A Passenger is a Person with a flight booking reference</span>
<span class="va">Passenger</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">person</span> <span class="op">=</span> <span class="fu">Person</span><span class="op">(</span><span class="op">)</span>, <span class="va">booking_reference</span> <span class="op">=</span> <span class="cn">NA_character_</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">person</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="fu">Person</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">booking_reference</span><span class="op">)</span><span class="op">)</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span>
    <span class="va">person</span> 
    <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>booking_reference <span class="op">=</span> <span class="va">booking_reference</span><span class="op">)</span>
    <span class="op">%&gt;%</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">booking_reference</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">person</span> <span class="op">&lt;-</span> <span class="fu">Person</span><span class="op">(</span>given <span class="op">=</span> <span class="st">"Bilbo"</span>, family <span class="op">=</span> <span class="st">"Baggins"</span><span class="op">)</span>
<span class="va">passenger</span> <span class="op">&lt;-</span> <span class="fu">Passenger</span><span class="op">(</span>person <span class="op">=</span> <span class="va">person</span>, booking_reference <span class="op">=</span> <span class="st">"B662HR"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">passenger</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;   given family  booking_reference</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;            </span>
<span class="co">#&gt; 1 Bilbo Baggins B662HR</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A Diner is a Person that may have dinner reservation</span>
<span class="va">Diner</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">person</span> <span class="op">=</span> <span class="fu">Person</span><span class="op">(</span><span class="op">)</span>, <span class="va">reservation_time</span> <span class="op">=</span> <span class="va">NA_POSIXct_</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">person</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="fu">Person</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu">is.POSIXct</span><span class="op">(</span><span class="va">reservation_time</span><span class="op">)</span><span class="op">)</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span>
    <span class="va">person</span> 
    <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>reservation_time <span class="op">=</span> <span class="va">reservation_time</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">person</span> <span class="op">&lt;-</span> <span class="fu">Person</span><span class="op">(</span>given <span class="op">=</span> <span class="st">"Bilbo"</span>, family <span class="op">=</span> <span class="st">"Baggins"</span><span class="op">)</span>
<span class="va">timestamp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"2021-01-23 18:00:00 NZDT"</span><span class="op">)</span>
<span class="va">diner</span> <span class="op">&lt;-</span> <span class="fu">Diner</span><span class="op">(</span>person <span class="op">=</span> <span class="va">person</span>, reservation_time <span class="op">=</span> <span class="va">timestamp</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">diner</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;   given family  reservation_time   </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;dttm&gt;             </span>
<span class="co">#&gt; 1 Bilbo Baggins 2021-01-23 18:00:00</span></code></pre></div>
</div>
<div id="when-to-use-it" class="section level2">
<h2 class="hasAnchor">
<a href="#when-to-use-it" class="anchor"></a>When to Use It</h2>
<ul>
<li><p>In situations where domain concepts are more important then the database schema. For example, when you are modelling Passengers, your first instinct might be to think about the different data sources you’d need for the analysis. You may envision “FlightDetails” and “CustomerDetails”. Next you will define the relationship between them. Instead, let the domain drive the design. Create a Passenger <strong>Value Object</strong> with the attributes you must have, regardless of any particular database schema.</p></li>
<li><p>In a function that runs within a specific context. Rather than having an input argument called <code>data</code> of type <code>data.frame</code>, use the appropriate <strong>Value Object</strong> name and pass it its constructor.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Audience</span> <span class="op">&lt;-</span> <span class="va">Person</span>

<span class="co">## Without a Value Object</span>
<span class="va">clean_audience_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">data</span>, given <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_title</a></span><span class="op">(</span><span class="va">given</span><span class="op">)</span><span class="op">)</span>

<span class="co">## With a Value Object</span>
<span class="va">clean_audience_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">attendees</span> <span class="op">=</span> <span class="fu">Audience</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">attendees</span>, given <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_title</a></span><span class="op">(</span><span class="va">given</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<ul>
<li>In <a href="https://en.wikipedia.org/wiki/Pipeline_(software)">pipes and filters</a>.</li>
</ul>
<div class="alert alert-warning">
<p><strong>Note:</strong> <strong>Value Objects</strong> do not need to have unit-tests. This is because of two reasons: (1) <strong>Value Objects</strong> are often called by other functions that are being tested. That means, <strong>Value Objects</strong> are implicitly tested. (2) <strong>Value Objects</strong> are data types similarly to ‘data.frame’ or ‘list’. As such, they need no testing</p>
</div>
<!-- Example -->
</div>
<div id="example-person-and-minister-value-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#example-person-and-minister-value-objects" class="anchor"></a>Example: Person and Minister Value Objects</h2>
<p>In this example, we are appointing elected officials to random ministries, just like in real life.</p>
<p>The nomination process comprises three components: input, function, output.</p>
<ul>
<li>The input is the given and family names of a <strong>Person</strong>
</li>
<li>The function receives a <strong>Person</strong> value object and pairs it with ministry titles</li>
<li>The output is a <strong>Minister</strong> value object</li>
</ul>
<p><strong>Person</strong> -&gt; appoint_random_ministries</p>
<p>First, we implement the input type. <code>Person()</code> is the constructor of the <strong>Person</strong> value object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @title Person Value Object Constructor</span>
<span class="co">#' @description A Person encapsulates the information that constitute an individual </span>
<span class="co">#' @param given (`character`) Individual first name.</span>
<span class="co">#' @param family (`character`) Individual last name.</span>
<span class="co">#' @return (`Person`) Person value object.</span>
<span class="va">Person</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">given</span> <span class="op">=</span> <span class="cn">NA_character_</span>, <span class="va">family</span> <span class="op">=</span> <span class="cn">NA_character_</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">given</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">given</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span><span class="op">)</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span>
    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>given <span class="op">=</span> <span class="va">given</span>, family <span class="op">=</span> <span class="va">family</span><span class="op">)</span>
    <span class="op">%&gt;%</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">given</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="fu">Person</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 0 x 2</span>
<span class="co">#&gt; # … with 2 variables: given &lt;chr&gt;, family &lt;chr&gt;</span></code></pre></div>
<p>In addition, we implement a predicate that validates whether an arbitrary <code>data.frame</code> is a <strong>Person</strong> value object.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a test for objects of type Person</span>
<span class="co"># * Extract the column names of Person by using its Null Object (returned by Person())</span>
<span class="co"># * Check that the input argument has all the columns that a Person has</span>
<span class="va">is.Person</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="fu">Person</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Second, we implement the output type. <code>Minister()</code> is the constructor of the <strong>Minister</strong> value object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @title Minister Value Object Constructor</span>
<span class="co">#' @decription A 'Minister' is a 'Person' with a ministry title. </span>
<span class="co">#' @param Person (`Person`) A member of parliament.</span>
<span class="co">#' @param title (`character`) A string with one or more ministry titles.</span>
<span class="co">#' @return (`Minister`) Minister value object.</span>
<span class="va">Minister</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">member</span> <span class="op">=</span> <span class="fu">Person</span><span class="op">(</span><span class="op">)</span>, <span class="va">title</span> <span class="op">=</span> <span class="cn">NA_character_</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu">is.Person</span><span class="op">(</span><span class="va">member</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">member</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">member</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Third, we write a function that transforms <strong>Person</strong> into <strong>Minister</strong>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @title Appoint Parliament Members to Ministries</span>
<span class="co">#' @decription</span>
<span class="co">#' Given one or more parliament members</span>
<span class="co">#' When appoint_random_ministries is called</span>
<span class="co">#' Then the parliament members are appointed to an office.</span>
<span class="co">#' @param memeber (`Person`) A Person value object.</span>
<span class="co">#' @return (`Minister`) Minister value object.</span>
<span class="va">appoint_random_ministries</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">member</span> <span class="op">=</span> <span class="fu">Person</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"Arts, Culture and Heritage"</span>, <span class="st">"Finance"</span>, <span class="st">"Corrections"</span>,
    <span class="st">"Racing"</span>, <span class="st">"Sport and Recreation"</span>, <span class="st">"Housing"</span>, <span class="st">"Energy and Resources"</span>,
    <span class="st">"Education"</span>, <span class="st">"Public Service"</span>, <span class="st">"Disability Issues"</span>, <span class="st">"Environment"</span>,
    <span class="st">"Justice"</span>, <span class="st">"Immigration"</span>, <span class="st">"Defence"</span>, <span class="st">"Internal Affairs"</span>, <span class="st">"Transport"</span>
  <span class="op">)</span>
  
  <span class="fu">Minister</span><span class="op">(</span>member <span class="op">=</span> <span class="va">member</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">positions</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">member</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Finally, we pair parliament members with ministries</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Listing New Zealand elected officials in 2020, we instantiate a Person Object,</span>
<span class="co"># appoint them to random offices and return a Member value object.</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>

<span class="va">parliament_members</span> <span class="op">&lt;-</span> <span class="fu">Person</span><span class="op">(</span>
  given <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Jacinda"</span>, <span class="st">"Grant"</span>,     <span class="st">"Kelvin"</span>, <span class="st">"Megan"</span>, <span class="st">"Chris"</span>,   <span class="st">"Carmel"</span><span class="op">)</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ardern"</span>, <span class="st">"Robertson"</span>, <span class="st">"Davis"</span>,  <span class="st">"Woods"</span>, <span class="st">"Hipkins"</span>, <span class="st">"Sepuloni"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">parliament_members</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   given   family   </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;    </span>
<span class="co">#&gt; 1 Jacinda Ardern   </span>
<span class="co">#&gt; 2 Grant   Robertson</span>
<span class="co">#&gt; 3 Kelvin  Davis    </span>
<span class="co">#&gt; 4 Megan   Woods    </span>
<span class="co">#&gt; 5 Chris   Hipkins  </span>
<span class="co">#&gt; 6 Carmel  Sepuloni</span>

<span class="fu">appoint_random_ministries</span><span class="op">(</span>member <span class="op">=</span> <span class="va">parliament_members</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt;   given   family    title                     </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;                     </span>
<span class="co">#&gt; 1 Jacinda Ardern    Justice                   </span>
<span class="co">#&gt; 2 Grant   Robertson Transport                 </span>
<span class="co">#&gt; 3 Kelvin  Davis     Energy and Resources      </span>
<span class="co">#&gt; 4 Megan   Woods     Housing                   </span>
<span class="co">#&gt; 5 Chris   Hipkins   Education                 </span>
<span class="co">#&gt; 6 Carmel  Sepuloni  Arts, Culture and Heritage</span></code></pre></div>
</div>
<div id="further-reading" class="section level2">
<h2 class="hasAnchor">
<a href="#further-reading" class="anchor"></a>Further Reading</h2>
<p><a href="https://en.wikipedia.org/wiki/Value_object">Value Object on Wikipedia</a></p>
<div id="refs" class="references">
<div id="ref-Vernon2013">
<p>Vernon, Vaughn. 2013. <em>Implementing Domain-Driven Design</em>. 1st Edition. Addison-Wesley Professional.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/harell">Harel Lustiger</a>, <a href="https://github.com/tidylab"><img src="https://github.com/tidylab/tidylab/blob/master/favicon/apple-touch-icon-120x120.png?raw=true" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'd5f049d51d6123dd767e5f8bc7882c35',
    indexName: 'tidylab-r6p',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
